:root {
  color-scheme: dark;
  font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: #10141f;
  color: #f2f5ff;
  overflow-x: hidden;
}

.app {
  width: min(980px, 100%);
  max-width: 100vw;
  margin: clamp(0.75rem, 3vw, 2rem) auto;
  padding-inline: clamp(0.5rem, 3vw, 1rem);
  display: grid;
  gap: 1rem;
}

.topbar {
  display: block;
  position: sticky;
  top: 0;
  z-index: 24;
}

.icon-button {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  text-align: center;
  padding: 0;
  font-size: 1.2rem;
}

.settings-cog {
  position: absolute;
  top: 0.55rem;
  right: 0.55rem;
  z-index: 40;
}

body.left-handed-mode .settings-cog {
  right: auto;
  left: 0.55rem;
}

h1,
h2,
p {
  margin: 0;
}

h3 {
  margin: 0;
}

.panel {
  background: #1b2233;
  border: 1px solid #2b3550;
  min-width: 0;
  border-radius: 12px;
  padding: 1rem;
}

.stats {
  --stats-pad: clamp(0.55rem, 1.2vw, 1rem);
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr)) auto;
  gap: clamp(0.35rem, 1.2vw, 0.75rem);
  align-items: end;
  min-width: 0;
  position: relative;
  padding: var(--stats-pad);
  padding-right: calc(var(--stats-pad) + 2.9rem);
}

body.left-handed-mode .stats {
  padding-right: var(--stats-pad);
  padding-left: calc(var(--stats-pad) + 2.9rem);
}

.topbar-actions {
  grid-column: 3;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 0.45rem;
  align-self: end;
}

.topbar-action-button {
  text-align: center;
  min-width: clamp(78px, 16vw, 104px);
  padding: clamp(0.45rem, 1vw, 0.7rem) clamp(0.55rem, 1.1vw, 0.9rem);
}

.settings-toggle-mobile {
  display: none;
}

.mobile-footer {
  display: none;
}

.mobile-footer-button {
  text-align: center;
}

.label {
  display: block;
  opacity: 0.75;
  font-size: clamp(0.72rem, 1.3vw, 0.85rem);
  margin-bottom: 0.25rem;
}

strong {
  font-size: clamp(0.95rem, 2.1vw, 1.2rem);
}

.miner-stat-row {
  display: flex;
  justify-content: space-between;
  gap: 0.5rem;
  font-size: 0.85rem;
  margin: 0;
}

.miner-stat-row span {
  opacity: 0.8;
}

.miner-stat-row strong {
  font-size: 0.9rem;
}

.miner-stat-details {
  display: grid;
  gap: 0.2rem;
  margin-top: 0.25rem;
}

.upgrades-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.upgrades-modal-card {
  max-width: 640px;
  min-height: auto;
}

.workers-modal-card {
  max-width: 640px;
  min-height: auto;
}

.workers-modal-body {
  display: grid;
  gap: 0.8rem;
}

.worker-details-modal-body {
  display: grid;
  gap: 0.8rem;
  overflow-y: auto;
}

.worker-details-panel-host {
  display: grid;
  gap: 0.7rem;
  width: 100%;
}

.workers-section {
  display: grid;
  gap: 0.55rem;
}

.workers-section h3 {
  font-size: 0.9rem;
  color: #9bbdeb;
}

.workers-list {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 0.45rem;
}

.workers-list-item {
  min-width: 0;
  white-space: nowrap;
  text-align: center;
}

.workers-list-item.active {
  background: #2b64b8;
  border-color: #3f7bd4;
}

.workers-empty {
  opacity: 0.8;
  font-size: 0.85rem;
}

.workers-panel-host {
  display: grid;
  gap: 0.7rem;
}

.workers-panel-host .miner-stats-panel {
  position: static;
  top: auto;
  left: auto;
  right: auto;
  width: 100%;
  margin-bottom: 0;
}

.workers-panel-host .miner-popup {
  position: static;
  top: auto;
  left: auto;
  right: auto;
  width: 100%;
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}

.worker-details-panel-host .miner-stats-panel {
  position: static;
  top: auto;
  left: auto;
  right: auto;
  width: 100%;
  max-width: 100%;
  margin-bottom: 0;
}

.worker-details-panel-host #miner-stats-panel.left-side-menu {
  width: 100%;
  max-width: 100%;
}

.worker-details-panel-host .miner-popup {
  position: static;
  top: auto;
  left: auto;
  right: auto;
  width: 100%;
  margin-top: 0;
  padding-top: 0;
  border-top: none;
}

.workers-panel-host #close-miner-stats,
.workers-panel-host #close-miner-popup,
.worker-details-panel-host #close-miner-stats,
.worker-details-panel-host #close-miner-popup {
  display: none;
}

.upgrades-modal-body {
  display: grid;
  gap: 0.65rem;
}

.upgrades-accordion-body {
  display: grid;
  gap: 0.75rem;
  max-height: 65vh;
  overflow-y: auto;
  padding-right: 0.2rem;
}

.upgrades-accordion-body.hidden {
  display: none !important;
}

.hidden {
  display: none !important;
}

.modal {
  position: fixed;
  inset: 0;
  z-index: 30;
  display: grid;
  place-items: center;
}

.modal.hidden {
  display: none;
}

.modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgb(16 20 31 / 70%);
}

.modal-card {
  position: relative;
  width: 60vw;
  max-width: 900px;
  min-width: 320px;
  min-height: 60vh;
  display: grid;
  grid-template-rows: auto 1fr;
  gap: 0;
  padding: 0;
}

.inventory-modal-card {
  max-width: 620px;
  min-height: auto;
}

#inventory-modal .modal-header h2 {
  text-align: center;
}

#upgrades-modal .modal-header h2 {
  text-align: center;
}

#workers-modal .modal-header h2 {
  text-align: center;
}

@media (min-width: 861px) {
  #inventory-modal {
    place-items: stretch start;
    pointer-events: none;
  }

  #upgrades-modal {
    place-items: stretch end;
    pointer-events: none;
  }

  #worker-details-modal {
    place-items: stretch end;
    pointer-events: none;
  }

  #inventory-modal .modal-backdrop {
    display: none;
  }

  #upgrades-modal .modal-backdrop {
    display: none;
  }

  #worker-details-modal .modal-backdrop {
    display: none;
  }

  #inventory-modal .inventory-modal-card {
    width: min(460px, 92vw);
    max-width: 460px;
    min-height: 100vh;
    height: 100vh;
    margin: 0;
    border-radius: 0 12px 12px 0;
    pointer-events: auto;
  }

  #upgrades-modal .upgrades-modal-card {
    width: min(460px, 92vw);
    max-width: 460px;
    min-height: 100vh;
    height: 100vh;
    margin: 0;
    border-radius: 12px 0 0 12px;
    pointer-events: auto;
  }

  #worker-details-modal .worker-details-modal-card {
    width: min(460px, 92vw);
    max-width: 460px;
    min-height: 100vh;
    height: 100vh;
    margin: 0;
    border-radius: 12px 0 0 12px;
    pointer-events: auto;
  }

  #inventory-modal .modal-body {
    overflow-y: auto;
  }

  #upgrades-modal .modal-body {
    overflow-y: auto;
  }

  #worker-details-modal .modal-body {
    overflow-y: auto;
  }

  #miner-stats-panel.left-side-menu {
    left: 0;
    right: auto;
    top: calc(100% + 0.75rem);
    width: 260px;
  }

  body.left-handed-mode #inventory-modal {
    place-items: stretch end;
  }

  body.left-handed-mode #inventory-modal .inventory-modal-card {
    border-radius: 12px 0 0 12px;
  }

  body.left-handed-mode #upgrades-modal {
    place-items: stretch start;
  }

  body.left-handed-mode #upgrades-modal .upgrades-modal-card {
    border-radius: 0 12px 12px 0;
  }

  body.left-handed-mode #worker-details-modal {
    place-items: stretch start;
  }

  body.left-handed-mode #worker-details-modal .worker-details-modal-card {
    border-radius: 0 12px 12px 0;
  }

  body.left-handed-mode .miner-popup {
    left: auto;
    right: calc(100% + 1rem);
  }

  body.left-handed-mode #miner-stats-panel.left-side-menu {
    left: auto;
    right: 0;
  }
}

.inventory-header-row,
.inventory-row {
  display: grid;
  grid-template-columns: 1.2fr 0.7fr 0.7fr 0.8fr 0.9fr;
  gap: 0.5rem;
  align-items: center;
  font-size: 0.85rem;
}

.inventory-header-row {
  opacity: 0.75;
  border-bottom: 1px solid rgb(156 181 235 / 20%);
  padding-bottom: 0.3rem;
  margin-bottom: 0.35rem;
}

.inventory-list {
  display: grid;
  gap: 0.25rem;
}

.inventory-sell-all-btn {
  padding: 0.2rem 0.35rem;
  border-radius: 7px;
  font-size: 0.68rem;
}

.modal-header {
  display: grid;
  gap: 0.8rem;
  padding: 1rem 1.1rem;
  border-bottom: 1px solid #2b3550;
}

.modal-body {
  display: block;
  padding: 1.1rem;
}

.settings-section {
  display: grid;
  gap: 0.55rem;
}

.settings-section h3 {
  font-size: 0.9rem;
  color: #9bbdeb;
}

.dev-log-modal-card {
  width: min(680px, 92vw);
  min-height: auto;
  max-height: min(82vh, 760px);
}

.dev-log-body {
  overflow-y: auto;
}

.dev-log-accordion {
  display: grid;
  gap: 0.55rem;
}

.dev-log-entry {
  border: 1px solid #2b3550;
  border-radius: 10px;
  background: #182239;
  padding: 0.5rem 0.65rem;
}

.dev-log-entry-summary {
  cursor: pointer;
  font-weight: 600;
  color: #d4e8ff;
}

.dev-log-notes {
  margin: 0.45rem 0 0;
  padding-left: 1.15rem;
  display: grid;
  gap: 0.25rem;
  opacity: 0.9;
  font-size: 0.9rem;
}

.dev-log-notes li {
  white-space: pre-line;
}

.modal-actions {
  display: grid;
  gap: 0.55rem;
  justify-content: flex-start;
  width: fit-content;
}

.modal-actions button {
  width: auto;
  min-width: 90px;
  padding: 0.45rem 0.7rem;
}

.content-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
  align-items: start;
}

.panel.map {
  grid-column: 1;
  position: relative;
  overflow: visible;
}

.map {
  display: grid;
  --tile-size: 38px;
  gap: 0.75rem;
  justify-items: center;
}

.map-meta {
  opacity: 0.85;
}

.left-side-menu {
  position: absolute;
  right: calc(100% + 1rem);
  top: 0;
}

.left-side-menu.hidden {
  display: none !important;
}

.resource-stats-panel {
  width: 240px;
  padding: 0.55rem 0.65rem;
  display: grid;
  gap: 0.35rem;
}

.resource-stats-panel-inline {
  width: 100%;
  padding: 0;
  margin-bottom: 0.75rem;
}

.resource-stats-panel h3 {
  font-size: 0.8rem;
  color: #9bbdeb;
}

.resource-legend-header,
.resource-legend-row {
  display: grid;
  grid-template-columns: 1.2fr 1fr 0.8fr 0.6fr 0.9fr;
  gap: 0.45rem;
  font-size: 0.78rem;
  align-items: center;
}

.resource-stats-actions {
  display: flex;
  align-items: center;
  gap: 0.35rem;
}

.resource-sell-all {
  padding: 0.25rem 0.45rem;
  border-radius: 7px;
  font-size: 0.72rem;
}

.resource-sell-btn {
  padding: 0.2rem 0.35rem;
  border-radius: 7px;
  font-size: 0.68rem;
}

.resource-accordion-btn {
  min-width: 4.25rem;
  text-align: center;
}

.resource-sell-placeholder {
  opacity: 0.55;
}

.resource-legend-header {
  opacity: 0.75;
  border-bottom: 1px solid rgb(156 181 235 / 20%);
  padding-bottom: 0.2rem;
}

.resource-legend-row {
  margin: 0;
}

.resource-legend-name {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
}

.resource-legend-tile {
  display: inline-block;
  width: 14px;
  height: 14px;
  min-width: 14px;
  min-height: 14px;
  border-radius: 4px;
  border: 1px solid rgb(43 53 80 / 70%);
  box-shadow: inset 0 1px 1px rgb(255 255 255 / 18%);
  pointer-events: none;
  cursor: default;
}

.resource-legend-tile--gemstone {
  background: #9acbe3;
  border-color: #6f93a8;
  box-shadow: inset 0 1px 1px #bfdeed;
}

.resource-legend-section-row {
  margin: 0.2rem 0 0;
  padding-top: 0.3rem;
  border-top: 1px solid rgb(156 181 235 / 20%);
  font-size: 0.74rem;
  opacity: 0.8;
  white-space: nowrap;
}

.resource-legend-body {
  display: grid;
  gap: 0.15rem;
}

.map-environment {
  position: relative;
  display: grid;
  place-items: center;
  min-height: 320px;
  width: 100%;
}

body.placement-mode .map-environment,
body.placement-mode .map-grid {
  touch-action: none;
}

.miner-popup {
  position: absolute;
  left: calc(100% + 1rem);
  top: 0;
  width: 300px;
  background: #1b2233;
  border: 1px solid #2b3550;
  border-radius: 12px;
  padding: 0.85rem;
  display: grid;
  gap: 0.55rem;
  z-index: 12;
}

.miner-popup.hidden {
  display: none !important;
}

.miner-stats-panel {
  width: 220px;
  display: grid;
  gap: 0.45rem;
}

.miner-stats-panel.hidden {
  display: none !important;
}

.miner-popup-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 0.3rem;
}

.miner-popup h3 {
  margin: 0;
  font-size: 0.9rem;
  font-weight: 600;
  color: #9bbdeb;
}

.close-button {
  background: none;
  border: none;
  color: #9bbdeb;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 0;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.close-button:hover {
  color: #d4e8ff;
}

.map-grid {
  position: relative;
  z-index: 1;
  display: grid;
  --tile-size: 38px;
  --tile-gap: 6px;
  gap: var(--tile-gap);
  justify-content: center;
}

.mobile-reposition-controls {
  margin: 0.7rem 0 0;
  display: grid;
  gap: 0.55rem;
}

.mobile-reposition-prompt {
  margin: 0;
  font-size: 0.85rem;
  color: #9bbdeb;
}

.mobile-reposition-actions {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 0.5rem;
}

.mobile-reposition-worker-nav {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 0.5rem;
}

.reposition-worker-picker {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 0.45rem;
}

.reposition-worker-modal-card {
  width: min(92vw, 520px);
  min-height: auto;
}

.reposition-worker-option.active {
  background: #2b64b8;
  border-color: #3f7bd4;
}

.miner-ring {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 3;
}

.chain-lightning-arc {
  position: absolute;
  height: 3px;
  transform-origin: 0 50%;
  pointer-events: none;
  z-index: 2;
  border-radius: 999px;
  background: linear-gradient(90deg, rgb(143 211 255 / 92%), rgb(223 248 255 / 100%), rgb(143 211 255 / 0%));
  box-shadow:
    0 0 8px rgb(159 227 255 / 95%),
    0 0 16px rgb(125 197 255 / 70%);
  animation: chain-lightning-fade 1000ms linear forwards;
}

.miner-node {
  position: absolute;
  transform: translate(-50%, -50%);
  min-width: 42px;
  padding: 0.2rem 0.35rem;
  border-radius: 999px;
  border: 1px solid #45557b;
  background: #1a2949;
  color: #eaf0ff;
  font-size: 0.72rem;
  line-height: 1;
  text-align: center;
  white-space: nowrap;
  pointer-events: auto;
  cursor: grab;
  user-select: none;
}

.miner-node::after {
  content: "";
  position: absolute;
  left: 50%;
  top: 50%;
  width: calc(var(--miner-radius, 90px) * 2);
  height: calc(var(--miner-radius, 90px) * 2);
  transform: translate(-50%, -50%);
  border-radius: 50%;
  border: 1px dashed rgb(156 181 235 / 38%);
  background: rgb(78 108 173 / 8%);
  pointer-events: none;
}

.miner-node.dragging {
  cursor: grabbing;
}

body.placement-mode .miner-node.reposition-selected {
  border-color: #69a2ff;
  box-shadow:
    0 0 0 2px rgb(105 162 255 / 35%),
    0 0 12px rgb(105 162 255 / 55%);
}

.miner-node strong {
  display: block;
  font-size: 0.68rem;
  opacity: 0.85;
}

.map-tile {
  width: var(--tile-size);
  height: var(--tile-size);
  position: relative;
  border-radius: 6px;
  border: 1px solid #8d7548;
  background: #c8a873;
  box-shadow: inset 0 1px 1px #dcc79f;
  cursor: pointer;
}

.map-tile--crit-spark::after {
  content: "";
  position: absolute;
  inset: -4px;
  border-radius: 8px;
  pointer-events: none;
  background:
    radial-gradient(circle at 30% 30%, rgb(255 122 122 / 90%) 0 12%, transparent 46%),
    radial-gradient(circle at 72% 68%, rgb(255 84 84 / 82%) 0 14%, transparent 50%);
  box-shadow: 0 0 10px rgb(255 92 92 / 72%);
  animation: crit-spark-pop 420ms ease-out forwards;
}

.map-tile--electric-spark::before {
  content: "";
  position: absolute;
  inset: -3px;
  border-radius: 8px;
  pointer-events: none;
  background:
    conic-gradient(
      from 35deg,
      rgb(153 240 255 / 0%) 0deg,
      rgb(153 240 255 / 85%) 55deg,
      rgb(208 248 255 / 95%) 105deg,
      rgb(153 240 255 / 0%) 160deg,
      rgb(153 240 255 / 85%) 220deg,
      rgb(208 248 255 / 95%) 270deg,
      rgb(153 240 255 / 0%) 360deg
    );
  box-shadow:
    0 0 8px rgb(134 236 255 / 85%),
    0 0 14px rgb(86 204 255 / 70%);
  animation: electric-spark-burst 520ms ease-out forwards;
}

.map-tile:hover {
  filter: brightness(1.06);
}

.map-tile--cooldown {
  background: rgb(16 20 31 / 90%);
  border-color: #2b3550;
  box-shadow: inset 0 1px 1px rgb(56 72 108 / 35%);
  cursor: not-allowed;
  pointer-events: none;
}

.map-tile--coal {
  background: #4a4a4a;
  border-color: #2a2a2a;
  box-shadow: inset 0 1px 1px #6a6a6a;
}

.map-tile--coal:hover {
  filter: brightness(1.1);
}

.map-tile--copper {
  background: #b7773f;
  border-color: #7f4d24;
  box-shadow: inset 0 1px 1px #d89a68;
}

.map-tile--iron {
  background: #87909b;
  border-color: #5f6670;
  box-shadow: inset 0 1px 1px #a6adb8;
}

.map-tile--silver {
  background: #bcc4d6;
  border-color: #8c93a6;
  box-shadow: inset 0 1px 1px #dce2ef;
}

.map-tile--gold {
  background: #d9b455;
  border-color: #9f7d2b;
  box-shadow: inset 0 1px 1px #ebd083;
}

.map-tile--sapphire {
  background: #3d67cf;
  border-color: #2b4597;
  box-shadow: inset 0 1px 1px #6f91e0;
}

.map-tile--ruby {
  background: #c34158;
  border-color: #8f2d3f;
  box-shadow: inset 0 1px 1px #d97788;
}

.map-tile--emerald {
  background: #34a87b;
  border-color: #25785a;
  box-shadow: inset 0 1px 1px #65bf9b;
}

.map-tile--diamond {
  background: #9acbe3;
  border-color: #6f93a8;
  box-shadow: inset 0 1px 1px #bfdeed;
}

.map-tile--amethyst {
  background: #8a5ccf;
  border-color: #65429a;
  box-shadow: inset 0 1px 1px #b18be0;
}

.map-tile--enchant-bountiful {
  --enchant-color: rgb(83 209 124 / var(--tile-enchant-opacity, 1));
}

.map-tile--enchant-enriched {
  --enchant-color: rgb(179 120 255 / var(--tile-enchant-opacity, 1));
}

.map-tile--enchant-bountiful,
.map-tile--enchant-enriched {
  --enchant-step: 18px;
  --enchant-width: 2px;
  background-image: repeating-linear-gradient(
    45deg,
    transparent 0,
    transparent calc(var(--enchant-step) - var(--enchant-width)),
    var(--enchant-color) calc(var(--enchant-step) - var(--enchant-width)),
    var(--enchant-color) var(--enchant-step)
  );
}

.map-tile--enchant-strength-1 {
  --enchant-step: 20px;
  --enchant-width: 2px;
}

.map-tile--enchant-strength-2 {
  --enchant-step: 16px;
  --enchant-width: 2px;
}

.map-tile--enchant-strength-3 {
  --enchant-step: 13px;
  --enchant-width: 2px;
}

.map-tile--enchant-strength-4 {
  --enchant-step: 10px;
  --enchant-width: 2px;
}

.map-tile--enchant-strength-5 {
  --enchant-step: 8px;
  --enchant-width: 2px;
}

button {
  border: 1px solid #3a486a;
  background: #223051;
  color: #f2f5ff;
  border-radius: 10px;
  padding: 0.7rem 0.9rem;
  cursor: pointer;
  text-align: left;
}

button:hover {
  filter: brightness(1.1);
}

#popup-unlock-class {
  position: relative;
  z-index: 1;
  pointer-events: auto;
  transform: translateZ(0);
}

#popup-unlock-class:hover {
  filter: none;
  background: #2b3a61;
}

button:disabled {
  opacity: 0.45;
  cursor: not-allowed;
}

button.update-ready {
  background: #2f7f3c;
  border-color: #3ea152;
}

.settings-version {
  opacity: 0.8;
  font-size: 0.85rem;
}

.primary {
  background: #2a5ecf;
}

.danger {
  background: #7f2f3c;
}

.upgrade {
  display: grid;
  gap: 0.2rem;
}

.upgrade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.5rem;
}

.upgrade-quantity {
  font-size: 1rem;
  white-space: nowrap;
  flex-shrink: 0;
}

.upgrade small {
  opacity: 0.75;
  font-size: 0.8rem;
}

.upgrade-cost-row {
  font-size: 0.8rem;
  opacity: 0.85;
  margin-top: 0.05rem;
}

.status {
  min-height: 1.2rem;
  opacity: 0.85;
}

@keyframes crit-spark-pop {
  0% {
    opacity: 0;
    transform: scale(0.75);
  }
  35% {
    opacity: 1;
    transform: scale(1.08);
  }
  100% {
    opacity: 0;
    transform: scale(1.15);
  }
}

@keyframes chain-lightning-fade {
  0% {
    opacity: 1;
    filter: brightness(1.25);
  }
  100% {
    opacity: 0;
    filter: brightness(0.9);
  }
}

@keyframes electric-spark-burst {
  0% {
    opacity: 0;
    transform: scale(0.8) rotate(0deg);
  }
  30% {
    opacity: 1;
    transform: scale(1.04) rotate(24deg);
  }
  100% {
    opacity: 0;
    transform: scale(1.12) rotate(40deg);
  }
}

@media (max-width: 860px) {
  .app {
    width: 100%;
    max-width: 100%;
    margin: 0;
    padding-inline: 0.5rem;
  }

  .panel {
    width: 100%;
  }

  .content-layout {
    grid-template-columns: 1fr;
  }

  .panel.map {
    grid-column: 1;
    overflow: hidden;
  }

  .upgrades {
    grid-column: 1;
  }

  .miner-popup {
    position: static;
    width: 100%;
    margin-top: 1.2rem;
    padding-top: 1.2rem;
    border-top: 1px solid rgb(156 181 235 / 20%);
  }

  .miner-stats-panel {
    position: static;
    width: 100%;
    margin-bottom: 0.75rem;
  }

  .resource-stats-panel {
    position: static;
    width: 100%;
    margin-bottom: 0.75rem;
  }

  .left-side-menu {
    position: static;
  }

  .map-info-toggle {
    position: static;
    margin-bottom: 0.35rem;
  }

  .topbar {
    display: block;
  }

  .stats {
    grid-template-columns: repeat(2, minmax(0, 1fr));
    grid-auto-flow: row;
    align-items: center;
  }

  .topbar-actions {
    display: none;
  }

  #inventory-modal,
  #upgrades-modal,
  #workers-modal,
  #settings-modal,
  #dev-log-modal {
    place-items: stretch;
    z-index: 30;
  }

  #inventory-modal .modal-backdrop,
  #upgrades-modal .modal-backdrop,
  #workers-modal .modal-backdrop,
  #settings-modal .modal-backdrop,
  #dev-log-modal .modal-backdrop {
    display: none;
  }

  #inventory-modal .modal-card,
  #upgrades-modal .modal-card,
  #workers-modal .modal-card,
  #settings-modal .modal-card,
  #dev-log-modal .modal-card {
    width: 100%;
    max-width: 100%;
    min-width: 0;
    min-height: 100vh;
    border-radius: 0;
    border-left: none;
    border-right: none;
  }

  #settings-modal .modal-actions {
    width: 100%;
    justify-content: stretch;
  }

  #settings-modal .modal-header h2 {
    text-align: center;
  }

  #settings-modal .modal-actions button,
  #settings-modal #toggle-left-handed-mode,
  #settings-modal #open-dev-log,
  #settings-modal #check-for-updates {
    width: 100%;
    min-width: 0;
    text-align: center;
  }

  #dev-log-modal .modal-body {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: calc(5rem + env(safe-area-inset-bottom));
  }

  #inventory-modal .modal-body {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: calc(5rem + env(safe-area-inset-bottom));
  }

  #workers-modal .modal-body {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: calc(5rem + env(safe-area-inset-bottom));
  }

  #close-inventory-modal {
    display: none;
  }

  .topbar-action-button {
    min-width: 0;
    width: 100%;
  }

  .settings-cog {
    display: block;
  }

  .settings-toggle-mobile {
    display: block;
  }

  .app {
    padding-bottom: calc(5.8rem + env(safe-area-inset-bottom));
  }

  .mobile-footer {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 35;
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 0.45rem;
    padding: 0.7rem;
    padding-bottom: calc(0.7rem + env(safe-area-inset-bottom));
    background: #1b2233;
    border-top: 1px solid #2b3550;
  }

  .mobile-footer-button {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-width: 0;
    min-height: 3.25rem;
    padding: 0.9rem 1.15rem;
    font-size: 0.9rem;
    text-align: center;
  }

  .mobile-footer.mobile-footer-left-handed {
    direction: rtl;
  }

  .mobile-footer.mobile-footer-left-handed .mobile-footer-button {
    direction: ltr;
  }
}
